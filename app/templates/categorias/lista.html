{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h3">Lista de Categor√≠as</h1>
  <a href="{{ url_for('categorias.crear') }}" class="btn btn-primary">
    ‚ûï Nueva Categor√≠a
  </a>
</div>

<!-- Formulario de b√∫squeda -->
<form method="GET" class="row mb-3 align-items-end">
  <div class="col-md-6">
    <label for="q" class="form-label">Nombre</label>
    <input type="text" id="q" name="q" class="form-control" placeholder="Buscar categor√≠a" value="{{ q }}">
  </div>

  <div class="col-md-3">
    <label for="activo" class="form-label">Estado</label>
    <select id="activo" name="activo" class="form-select">
      <option value="">-- Todos --</option>
      <option value="1" {% if activo == '1' %}selected{% endif %}>Activa</option>
      <option value="0" {% if activo == '0' %}selected{% endif %}>Inactiva</option>
    </select>
  </div>

  <div class="col-md-3 text-end">
    <button type="submit" class="btn btn-primary w-100 shadow-sm">
      üîç Buscar
    </button>
  </div>
</form>

{% if q or activo %}
<div class="mb-3 text-end">
  <a href="{{ url_for('categorias.lista') }}" class="btn btn-secondary btn-sm">
    Limpiar filtros
  </a>
</div>
{% endif %}

<!-- Tabla de categor√≠as -->
<div class="card">
  <div class="card-body">
    {% if categorias %}
      <table class="table modern-table align-middle mb-0">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Descripci√≥n</th>
            <th>Estado</th>
            <th class="text-end">Acciones</th>
          </tr>
        </thead>
        <tbody>
          {% for c in categorias %}
          <tr>
            <td>
              <strong class="text-dark">{{ c.Nombre }}</strong>
              {% if not c.Activo %}
                <span class="badge bg-secondary ms-2">Inactiva</span>
              {% endif %}
            </td>
            <td class="text-muted">{{ c.Descripcion or '‚Äî' }}</td>
            <td>
              {% if c.Activo %}
                <span class="status-dot bg-success"></span> Activa
              {% else %}
                <span class="status-dot bg-danger"></span> Inactiva
              {% endif %}
            </td>
            <td class="text-end">
              <a href="{{ url_for('categorias.editar', id=c.Id) }}" 
                 class="btn btn-sm btn-outline-warning shadow-sm me-1">
                 Editar
              </a>
              <form action="{{ url_for('categorias.eliminar', id=c.Id) }}" 
                    method="post" class="d-inline">
                <button type="submit" class="btn btn-sm btn-outline-danger shadow-sm"
                        onclick="return confirm('¬øSeguro que deseas eliminar esta categor√≠a?')">
                  Eliminar
                </button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="text-muted text-center mb-0">No hay categor√≠as registradas.</p>
    {% endif %}
  </div>
</div>

{% endblock %}
